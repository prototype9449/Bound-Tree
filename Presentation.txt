В этом алгоритме мы имеем древовидную структуру опроса.
Каждый опрос имеет корень - Root. 
Узлы строго типизированы. То есть мы имеем 3DGrid, Grid, Single, OpenText, Answer, PredefinedList ... 
Для каждого узла устанавливается логический урвень. Например у корня - 0. Длаее Grid3D - 1 и т.д. 
У каждого узла, кроме корня есть родитель и лог уровень этого родителя меньше чем чем у этого узла. Кроме predefined list - у них одинаковый.

Например:
1) 3DGrid может содержать Grid, Single 
2) Grid может содержать Single, OpenText. 
3) Single может содержать PredefinedList, Answer. 
4) PredefinedList может содержать Answer. 
5) Но Answer уже ничего может в себе содержать.

Есть 3 вида связи в каждом соединении между двумя узлами
  а) Строгая - когда два узла связаны
  б) Относительная - когда связан хотя бы один из детей этих узлов
  в) Отсутствие, в этом случае узел заменяется на пустой

При добавлении связи происходит проверка : если связанны родители, то связи потомков внутри могут быть только между потомками этих родителей. Связать два узла возможно только если их логические уровни совпадают.

Работа алгоритма :
1) Копирование структуры левого дерева, тем самым на выходе будет два дерева с одинаковой структурой - но правое дерево будет состоять из пустых узлов.
2) Для каждого узла из левого дерева, с которым имеется связь в правом(пустом) дереве вместо пустого вставляем узел из первоначального правого дерева, с которым связан узел из левого дерева
3) В правом полупустом дереве пытаемся для каждого пустого узла восстановить его, основываясь на первоначальном правом дереве
4) Для каждого узла пытаемся вставить ребёнка между ним и его детьми, если в правом дереве имеется промежуточный узел

При соединении окончательня структура дерева формируется из главного опроса.
При соединении 2 и более деревьев получается один и тот же тип. При соединении получается также древовидная структура. То есть каждый узел также имеет свой тип. Но в каждом узле лежит структура из узлов разных опросов с соответсвующим типом связи. 